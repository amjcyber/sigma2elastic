{"id":"c0b2768a-dd06-4671-8339-b16ca8d1f27f","created_by":"frack113","name":"Fsutil Behavior Set SymlinkEvaluation","tags":["attack.execution","attack.t1059"],"interval":"5m","description":"A symbolic link is a type of file that contains a reference to another file.\nThis is probably done to make sure that the ransomware is able to follow shortcuts on the machine in order to find the original file to encrypt\n","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Legitimate use"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Ff][Ss][Uu][Tt][Ii][Ll]\\.[Ee][Xx][Ee]/ AND process.command_line:/.*[Bb][Ee][Hh][Aa][Vv][Ii][Oo][Rr]\\ .*/ AND process.command_line:/.*[Ss][Ee][Tt]\\ .*/ AND process.command_line:/.*[Ss][Yy][Mm][Ll][Ii][Nn][Kk][Ee][Vv][Aa][Ll][Uu][Aa][Tt][Ii][Oo][Nn].*/)","rule_id":"c0b2768a-dd06-4671-8339-b16ca8d1f27f","timestamp_override":"event.ingested","references":["https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware","https://docs.microsoft.com/fr-fr/windows-server/administration/windows-commands/fsutil-behavior"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\fsutil.exe AND process.command_line:*behavior\\ * AND process.command_line:*set\\ * AND process.command_line:*SymlinkEvaluation*)`"}

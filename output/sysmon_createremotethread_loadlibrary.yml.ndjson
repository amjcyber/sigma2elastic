{"id":"052ec6f6-1adc-41e6-907a-f1c813478bee","created_by":"Roberto Rodriguez @Cyb3rWard0g","name":"CreateRemoteThread API and LoadLibrary","tags":["attack.defense_evasion","attack.t1055.001"],"interval":"5m","description":"Detects potential use of CreateRemoteThread api and LoadLibrary function to inject DLL into a process","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(winlog.event_data.StartModule:/.*\\\\[Kk][Ee][Rr][Nn][Ee][Ll]32\\.[Dd][Ll][Ll]/ AND winlog.event_data.StartFunction:/[Ll][Oo][Aa][Dd][Ll][Ii][Bb][Rr][Aa][Rr][Yy][Aa]/)","rule_id":"052ec6f6-1adc-41e6-907a-f1c813478bee","timestamp_override":"event.ingested","references":["https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-180719170510.html"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(winlog.event_data.StartModule:*\\\\kernel32.dll AND winlog.event_data.StartFunction:LoadLibraryA)`"}

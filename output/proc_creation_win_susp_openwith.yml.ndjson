{"id":"cec8e918-30f7-4e2d-9bfa-a59cc97ae60f","created_by":"Beyu Denis, oscd.community (rule), @harr0ey (idea)","name":"OpenWith.exe Executes Specified Binary","tags":["attack.defense_evasion","attack.t1218"],"interval":"5m","description":"The OpenWith.exe executes other binary","risk_score":73,"enabled":true,"severity":"high","false_positives":["Legitimate use of OpenWith.exe by legitimate user"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Oo][Pp][Ee][Nn][Ww][Ii][Tt][Hh]\\.[Ee][Xx][Ee]/ AND process.command_line:/.*\\/[Cc].*/)","rule_id":"cec8e918-30f7-4e2d-9bfa-a59cc97ae60f","timestamp_override":"event.ingested","references":["https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OSBinaries/Openwith.yml","https://twitter.com/harr0ey/status/991670870384021504"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\OpenWith.exe AND process.command_line:*\\/c*)`"}

{"id":"29fd07fc-9cfd-4331-b7fd-cc18dfa21052","created_by":"Florian Roth","name":"Maze Ransomware","tags":["attack.execution","attack.t1204.002","attack.t1047","attack.impact","attack.t1490"],"interval":"5m","description":"Detects specific process characteristics of Maze ransomware word document droppers","risk_score":99,"enabled":true,"severity":"critical","false_positives":["Unlikely"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.parent.executable:/.*\\\\[Ww][Ii][Nn][Ww][Oo][Rr][Dd]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\.[Tt][Mm][Pp]/) OR (process.executable:/.*\\\\[Ww][Mm][Ii][Cc]\\.[Ee][Xx][Ee]/ AND process.parent.executable:/.*\\\\[Tt][Ee][Mm][Pp]\\\\.*/ AND process.command_line:/.*[Ss][Hh][Aa][Dd][Oo][Ww][Cc][Oo][Pp][Yy]\\ [Dd][Ee][Ll][Ee][Tt][Ee]/) OR (process.command_line:/.*[Ss][Hh][Aa][Dd][Oo][Ww][Cc][Oo][Pp][Yy]\\ [Dd][Ee][Ll][Ee][Tt][Ee]/ AND process.command_line:/.*\\\\\\.\\.\\\\\\.\\.\\\\[Ss][Yy][Ss][Tt][Ee][Mm]32.*/))","rule_id":"29fd07fc-9cfd-4331-b7fd-cc18dfa21052","timestamp_override":"event.ingested","references":["https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html","https://app.any.run/tasks/51e7185c-52d7-4efb-ac0d-e86340053473/","https://app.any.run/tasks/65a79440-373a-4725-8d74-77db9f2abda4/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.parent.executable:*\\\\WINWORD.exe AND process.executable:*.tmp) OR (process.executable:*\\\\wmic.exe AND process.parent.executable:*\\\\Temp\\\\* AND process.command_line:*shadowcopy\\ delete) OR (process.command_line:*shadowcopy\\ delete AND process.command_line:*\\\\..\\\\..\\\\system32*))`"}

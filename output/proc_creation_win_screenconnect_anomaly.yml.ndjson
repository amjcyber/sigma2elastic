{"id":"7b582f1a-b318-4c6a-bf4e-66fe49bf55a5","created_by":"Florian Roth","name":"ScreenConnect Backstage Mode Anomaly","tags":["attack.command_and_control","attack.t1219"],"interval":"5m","description":"Detects suspicious sub processes started by the ScreenConnect client service, which indicates the use of the so-called Backstage mode","risk_score":73,"enabled":true,"severity":"high","false_positives":["Case in which administrators are allowed to use ScreenConnect's Backstage mode"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.parent.executable:/.*[Ss][Cc][Rr][Ee][Ee][Nn][Cc][Oo][Nn][Nn][Ee][Cc][Tt]\\.[Cc][Ll][Ii][Ee][Nn][Tt][Ss][Ee][Rr][Vv][Ii][Cc][Ee]\\.[Ee][Xx][Ee]/ AND process.executable:(/.*\\\\[Cc][Mm][Dd]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Pp][Oo][Ww][Ee][Rr][Ss][Hh][Ee][Ll][Ll]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Pp][Ww][Ss][Hh]\\.[Ee][Xx][Ee]/))","rule_id":"7b582f1a-b318-4c6a-bf4e-66fe49bf55a5","timestamp_override":"event.ingested","references":["https://www.mandiant.com/resources/telegram-malware-iranian-espionage","https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Host_client/View_menu/Backstage_mode"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.parent.executable:*ScreenConnect.ClientService.exe AND process.executable:(*\\\\cmd.exe OR *\\\\powershell.exe OR *\\\\pwsh.exe))`"}

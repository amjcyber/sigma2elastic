{"id":"bef0bc5a-b9ae-425d-85c6-7b2d705980c6","created_by":"frack113","name":"Python Initiated Connection","tags":["attack.discovery","attack.t1046"],"interval":"5m","description":"Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Legitimate python script"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(network.direction:/[Tt][Rr][Uu][Ee]/ AND process.executable:/.*[Pp][Yy][Tt][Hh][Oo][Nn].*/)","rule_id":"bef0bc5a-b9ae-425d-85c6-7b2d705980c6","timestamp_override":"event.ingested","references":["https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md#atomic-test-4---port-scan-using-python","https://pypi.org/project/scapy/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(network.direction:true AND process.executable:*python*)`"}

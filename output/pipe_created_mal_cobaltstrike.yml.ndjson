{"id":"d5601f8c-b26f-4ab0-9035-69e11a8d4ad2","created_by":"Florian Roth, Wojciech Lesicki","name":"CobaltStrike Named Pipe","tags":["attack.defense_evasion","attack.privilege_escalation","attack.t1055"],"interval":"5m","description":"Detects the creation of a named pipe as used by CobaltStrike","risk_score":99,"enabled":true,"severity":"critical","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((file.name:/.*\\\\[Mm][Ss][Ss][Ee]\\-.*/ AND file.name:/.*\\-[Ss][Ee][Rr][Vv][Ee][Rr].*/) OR file.name:/\\\\[Pp][Oo][Ss][Tt][Ee][Xx]_.*/ OR file.name:/\\\\[Pp][Oo][Ss][Tt][Ee][Xx]_[Ss][Ss][Hh]_.*/ OR file.name:/\\\\[Ss][Tt][Aa][Tt][Uu][Ss]_.*/ OR file.name:/\\\\[Mm][Ss][Aa][Gg][Ee][Nn][Tt]_.*/)","rule_id":"d5601f8c-b26f-4ab0-9035-69e11a8d4ad2","timestamp_override":"event.ingested","references":["https://twitter.com/d4rksystem/status/1357010969264873472","https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/","https://github.com/Neo23x0/sigma/issues/253","https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((file.name:*\\\\MSSE\\-* AND file.name:*\\-server*) OR file.name:\\\\postex_* OR file.name:\\\\postex_ssh_* OR file.name:\\\\status_* OR file.name:\\\\msagent_*)`"}

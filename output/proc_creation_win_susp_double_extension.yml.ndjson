{"id":"1cdd9a09-06c9-4769-99ff-626e2b3991b8","created_by":"Florian Roth (rule), @blu3_team (idea)","name":"Suspicious Double Extension","tags":["attack.initial_access","attack.t1566.001"],"interval":"5m","description":"Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns","risk_score":99,"enabled":true,"severity":"critical","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"process.executable:(/.*\\.[Dd][Oo][Cc]\\.[Ee][Xx][Ee]/ OR /.*\\.[Dd][Oo][Cc][Xx]\\.[Ee][Xx][Ee]/ OR /.*\\.[Xx][Ll][Ss]\\.[Ee][Xx][Ee]/ OR /.*\\.[Xx][Ll][Ss][Xx]\\.[Ee][Xx][Ee]/ OR /.*\\.[Pp][Pp][Tt]\\.[Ee][Xx][Ee]/ OR /.*\\.[Pp][Pp][Tt][Xx]\\.[Ee][Xx][Ee]/ OR /.*\\.[Rr][Tt][Ff]\\.[Ee][Xx][Ee]/ OR /.*\\.[Pp][Dd][Ff]\\.[Ee][Xx][Ee]/ OR /.*\\.[Tt][Xx][Tt]\\.[Ee][Xx][Ee]/ OR /.*\\ \\ \\ \\ \\ \\ \\.[Ee][Xx][Ee]/ OR /.*______\\.[Ee][Xx][Ee]/)","rule_id":"1cdd9a09-06c9-4769-99ff-626e2b3991b8","timestamp_override":"event.ingested","references":["https://blu3-team.blogspot.com/2019/06/misleading-extensions-xlsexe-docexe.html","https://twitter.com/blackorbird/status/1140519090961825792"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`process.executable:(*.doc.exe OR *.docx.exe OR *.xls.exe OR *.xlsx.exe OR *.ppt.exe OR *.pptx.exe OR *.rtf.exe OR *.pdf.exe OR *.txt.exe OR *\\ \\ \\ \\ \\ \\ .exe OR *______.exe)`"}

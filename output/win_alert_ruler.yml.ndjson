{"id":"24549159-ac1b-479c-8175-d42aea947cae","created_by":"Florian Roth","name":"Hacktool Ruler","tags":["attack.discovery","attack.execution","attack.t1087","attack.t1114","attack.t1059","attack.t1550.002"],"interval":"5m","description":"This events that are generated when using the hacktool Ruler by Sensepost","risk_score":73,"enabled":true,"severity":"high","false_positives":["Go utilities that use staaldraad awesome NTLM library"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(winlog.channel:Security AND ((event.code:4776 AND winlog.event_data.Workstation:/[Rr][Uu][Ll][Ee][Rr]/) OR (event.code:(4624 OR 4625) AND source.domain:/[Rr][Uu][Ll][Ee][Rr]/)))","rule_id":"24549159-ac1b-479c-8175-d42aea947cae","timestamp_override":"event.ingested","references":["https://github.com/sensepost/ruler","https://github.com/sensepost/ruler/issues/47","https://github.com/staaldraad/go-ntlm/blob/cd032d41aa8ce5751c07cb7945400c0f5c81e2eb/ntlm/ntlmv1.go#L427","https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4776","https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(winlog.channel:Security AND ((event.code:4776 AND winlog.event_data.Workstation:RULER) OR (event.code:(4624 OR 4625) AND source.domain:RULER)))`"}

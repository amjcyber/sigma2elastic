{"id":"42333b2c-b425-441c-b70e-99404a17170f","created_by":"Nasreddine Bencherchali, Florian Roth","name":"Sliver C2 Implant Activity Pattern","tags":["attack.execution","attack.t1059"],"interval":"5m","description":"Detects process activity patterns as seen being used by Sliver C2 framework implants","risk_score":99,"enabled":true,"severity":"critical","false_positives":["Unlikely"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"process.command_line:/.*\\-[Nn][Oo][Ee][Xx][Ii][Tt]\\ \\-[Cc][Oo][Mm][Mm][Aa][Nn][Dd]\\ \\[[Cc][Oo][Nn][Ss][Oo][Ll][Ee]\\]\\:\\:[Oo][Uu][Tt][Pp][Uu][Tt][Ee][Nn][Cc][Oo][Dd][Ii][Nn][Gg]\\=\\[[Tt][Ee][Xx][Tt]\\.[Uu][Tt][Ff]8[Ee][Nn][Cc][Oo][Dd][Ii][Nn][Gg]\\]\\:\\:[Uu][Tt][Ff]8.*/","rule_id":"42333b2c-b425-441c-b70e-99404a17170f","timestamp_override":"event.ingested","references":["https://github.com/BishopFox/sliver/blob/79f2d48fcdfc2bee4713b78d431ea4b27f733f30/implant/sliver/shell/shell_windows.go#L36","https://www.microsoft.com/security/blog/2022/08/24/looking-for-the-sliver-lining-hunting-for-emerging-command-and-control-frameworks/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`process.command_line:*\\-NoExit\\ \\-Command\\ \\[Console\\]\\:\\:OutputEncoding\\=\\[Text.UTF8Encoding\\]\\:\\:UTF8*`"}

{"id":"ee5e119b-1f75-4b34-add8-3be976961e39","created_by":"Nasreddine Bencherchali","name":"Conhost.exe CommandLine Path Traversal","tags":["attack.execution","attack.t1059.003"],"interval":"5m","description":"detects the usage of path traversal in conhost.exe indicating possible command/argument confusion/hijacking","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unlikely"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.parent.command_line:/.*[Cc][Oo][Nn][Hh][Oo][Ss][Tt].*/ AND process.command_line:/.*\\/\\.\\.\\/\\.\\.\\/.*/)","rule_id":"ee5e119b-1f75-4b34-add8-3be976961e39","timestamp_override":"event.ingested","references":["https://pentestlab.blog/2020/07/06/indirect-command-execution/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.parent.command_line:*conhost* AND process.command_line:*\\/..\\/..\\/*)`"}

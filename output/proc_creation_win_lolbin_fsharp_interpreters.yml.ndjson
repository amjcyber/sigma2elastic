{"id":"b96b2031-7c17-4473-afe7-a30ce714db29","created_by":"Christopher Peacock @SecurePeacock, SCYTHE @scythe_io","name":"Use of FSharp Interpreters","tags":["attack.execution","attack.t1059"],"interval":"5m","description":"The FSharp Interpreters, FsiAnyCpu.exe and FSi.exe, can be used for AWL bypass and is listed in Microsoft recommended block rules.","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Legitimate use by a software developer."],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Ff][Ss][Ii][Aa][Nn][Yy][Cc][Pp][Uu]\\.[Ee][Xx][Ee]/ OR process.pe.original_file_name:/[Ff][Ss][Ii][Aa][Nn][Yy][Cc][Pp][Uu]\\.[Ee][Xx][Ee]/ OR process.executable:/.*\\\\[Ff][Ss][Ii]\\.[Ee][Xx][Ee]/ OR process.pe.original_file_name:/[Ff][Ss][Ii]\\.[Ee][Xx][Ee]/)","rule_id":"b96b2031-7c17-4473-afe7-a30ce714db29","timestamp_override":"event.ingested","references":["https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules","https://bohops.com/2020/11/02/exploring-the-wdac-microsoft-recommended-block-rules-part-ii-wfc-fsi/","https://lolbas-project.github.io/lolbas/OtherMSBinaries/FsiAnyCpu/","https://lolbas-project.github.io/lolbas/OtherMSBinaries/Fsi/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\fsianycpu.exe OR process.pe.original_file_name:fsianycpu.exe OR process.executable:*\\\\fsi.exe OR process.pe.original_file_name:fsi.exe)`"}

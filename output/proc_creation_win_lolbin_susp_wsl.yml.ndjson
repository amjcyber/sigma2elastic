{"id":"dec44ca7-61ad-493c-bfd7-8819c5faa09b","created_by":"oscd.community, Zach Stanford @svch0st, Nasreddine Bencherchali","name":"WSL Execution","tags":["attack.execution","attack.defense_evasion","attack.t1218","attack.t1202"],"interval":"5m","description":"Detects Possible usage of Windows Subsystem for Linux (WSL) binary as a LOLBIN","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Automation and orchestration scripts may use this method execute scripts etc"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.executable:/.*\\\\[Ww][Ss][Ll]\\.[Ee][Xx][Ee]/ OR process.pe.original_file_name:/[Ww][Ss][Ll]\\.[Ee][Xx][Ee]/) AND process.command_line:(/.*\\ \\-[Ee]\\ .*/ OR /.*\\ \\-\\-[Ee][Xx][Ee][Cc]\\ .*/ OR /.*\\ \\-\\-[Ss][Yy][Ss][Tt][Ee][Mm]\\ .*/ OR /.*\\ \\/[Mm][Nn][Tt]\\/[Cc].*/))","rule_id":"dec44ca7-61ad-493c-bfd7-8819c5faa09b","timestamp_override":"event.ingested","references":["https://lolbas-project.github.io/lolbas/OtherMSBinaries/Wsl/","https://twitter.com/nas_bench/status/1535431474429808642"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.executable:*\\\\wsl.exe OR process.pe.original_file_name:wsl.exe) AND process.command_line:(*\\ \\-e\\ * OR *\\ \\-\\-exec\\ * OR *\\ \\-\\-system\\ * OR *\\ \\/mnt\\/c*))`"}

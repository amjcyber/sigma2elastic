{"id":"f37aba28-a9e6-4045-882c-d5004043b337","created_by":"frack113","name":"Suspicious Cmdl32 Execution","tags":["attack.execution","attack.defense_evasion","attack.t1218","attack.t1202"],"interval":"5m","description":"lolbas Cmdl32 is use to download a payload to evade antivirus","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.executable:/.*\\\\[Cc][Mm][Dd][Ll]32\\.[Ee][Xx][Ee]/ OR process.pe.original_file_name:/[Cc][Mm][Dd][Ll]32\\.[Ee][Xx][Ee]/) AND (process.command_line:/.*\\/[Vv][Pp][Nn]\\ .*/ AND process.command_line:/.*\\/[Ll][Aa][Nn]\\ .*/))","rule_id":"f37aba28-a9e6-4045-882c-d5004043b337","timestamp_override":"event.ingested","references":["https://lolbas-project.github.io/lolbas/Binaries/Cmdl32/","https://twitter.com/SwiftOnSecurity/status/1455897435063074824"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.executable:*\\\\cmdl32.exe OR process.pe.original_file_name:CMDL32.EXE) AND (process.command_line:*\\/vpn\\ * AND process.command_line:*\\/lan\\ *))`"}

{"id":"d65aee4d-2292-4cea-b832-83accd6cfa43","created_by":"Nasreddine Bencherchali","name":"Execute Arbitrary Binaries Using GUP Utility","tags":["attack.execution"],"interval":"5m","description":"Detects execution of the Notepad++ updater (gup) to launch other commands or executables","risk_score":73,"enabled":true,"severity":"high","false_positives":["Other parent binaries using GUP not currently identified"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.parent.executable:/.*\\\\[Gg][Uu][Pp]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Ee][Xx][Pp][Ll][Oo][Rr][Ee][Rr]\\.[Ee][Xx][Ee]/) AND (NOT (process.executable:/.*\\\\[Ee][Xx][Pp][Ll][Oo][Rr][Ee][Rr]\\.[Ee][Xx][Ee]/ AND process.command_line:/.*\\\\[Nn][Oo][Tt][Ee][Pp][Aa][Dd]\\+\\+\\\\[Nn][Oo][Tt][Ee][Pp][Aa][Dd]\\+\\+\\.[Ee][Xx][Ee].*/)))","rule_id":"d65aee4d-2292-4cea-b832-83accd6cfa43","timestamp_override":"event.ingested","references":["https://twitter.com/nas_bench/status/1535322445439180803"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.parent.executable:*\\\\gup.exe AND process.executable:*\\\\explorer.exe) AND (NOT (process.executable:*\\\\explorer.exe AND process.command_line:*\\\\Notepad\\+\\+\\\\notepad\\+\\+.exe*)))`"}

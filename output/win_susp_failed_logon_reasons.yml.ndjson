{"id":"9eb99343-d336-4020-a3cd-67f3819e68ee","created_by":"Florian Roth","name":"Account Tampering - Suspicious Failed Logon Reasons","tags":["attack.persistence","attack.defense_evasion","attack.privilege_escalation","attack.initial_access","attack.t1078"],"interval":"5m","description":"This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.","risk_score":47,"enabled":true,"severity":"medium","false_positives":["User using a disabled account"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(winlog.channel:Security AND (event.code:(4625 OR 4776) AND winlog.event_data.Status:(/0[Xx][Cc]0000072/ OR /0[Xx][Cc]000006[Ff]/ OR /0[Xx][Cc]0000070/ OR /0[Xx][Cc]0000413/ OR /0[Xx][Cc]000018[Cc]/ OR /0[Xx][Cc]000015[Bb]/)) AND (NOT (user.id:/[Ss]\\-1\\-0\\-0/)))","rule_id":"9eb99343-d336-4020-a3cd-67f3819e68ee","timestamp_override":"event.ingested","references":["https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4625","https://twitter.com/SBousseaden/status/1101431884540710913"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(winlog.channel:Security AND (event.code:(4625 OR 4776) AND winlog.event_data.Status:(0xC0000072 OR 0xC000006F OR 0xC0000070 OR 0xC0000413 OR 0xC000018C OR 0xC000015B)) AND (NOT (user.id:S\\-1\\-0\\-0)))`"}

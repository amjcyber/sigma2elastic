{"id":"0403d67d-6227-4ea8-8145-4e72db7da120","created_by":"frack113","name":"UtilityFunctions.ps1 Proxy Dll","tags":["attack.defense_evasion","attack.t1216"],"interval":"5m","description":"Detects the use of a Microsoft signed script executing a managed DLL with PowerShell.","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"process.command_line:(/.*[Uu][Tt][Ii][Ll][Ii][Tt][Yy][Ff][Uu][Nn][Cc][Tt][Ii][Oo][Nn][Ss]\\.[Pp][Ss]1.*/ OR /.*[Rr][Ee][Gg][Ss][Nn][Aa][Pp][Ii][Nn]\\ .*/)","rule_id":"0403d67d-6227-4ea8-8145-4e72db7da120","timestamp_override":"event.ingested","references":["https://lolbas-project.github.io/lolbas/Scripts/UtilityFunctions/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`process.command_line:(*UtilityFunctions.ps1* OR *RegSnapin\\ *)`"}

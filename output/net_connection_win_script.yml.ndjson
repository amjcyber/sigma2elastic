{"id":"08249dc0-a28d-4555-8ba5-9255a198e08c","created_by":"frack113","name":"Script Initiated Connection","tags":["attack.command_and_control","attack.t1105"],"interval":"5m","description":"Detects a script interpreter wscript/cscript opening a network connection. Adversaries may use script to download malicious payloads.","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Legitimate scripts"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(network.direction:/[Tt][Rr][Uu][Ee]/ AND process.executable:(/.*\\\\[Ww][Ss][Cc][Rr][Ii][Pp][Tt]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Cc][Ss][Cc][Rr][Ii][Pp][Tt]\\.[Ee][Xx][Ee]/))","rule_id":"08249dc0-a28d-4555-8ba5-9255a198e08c","timestamp_override":"event.ingested","references":["https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(network.direction:true AND process.executable:(*\\\\wscript.exe OR *\\\\cscript.exe))`"}

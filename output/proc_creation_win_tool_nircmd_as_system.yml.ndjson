{"id":"d9047477-0359-48c9-b8c7-792cedcdc9c4","created_by":"Florian Roth, Nasreddine Bencherchali @nas_bench","name":"NirCmd Tool Execution As LOCAL SYSTEM","tags":["attack.execution","attack.t1569.002","attack.s0029"],"interval":"5m","description":"Detects the use of NirCmd tool for command execution as SYSTEM user","risk_score":73,"enabled":true,"severity":"high","false_positives":["Legitimate use by administrators"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"process.command_line:/.*\\ [Rr][Uu][Nn][Aa][Ss][Ss][Yy][Ss][Tt][Ee][Mm]\\ .*/","rule_id":"d9047477-0359-48c9-b8c7-792cedcdc9c4","timestamp_override":"event.ingested","references":["https://www.nirsoft.net/utils/nircmd.html","https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/","https://www.nirsoft.net/utils/nircmd2.html#using"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`process.command_line:*\\ runassystem\\ *`"}

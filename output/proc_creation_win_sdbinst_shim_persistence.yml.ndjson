{"id":"517490a7-115a-48c6-8862-1a481504d5a8","created_by":"Markus Neis","name":"Possible Shim Database Persistence via sdbinst.exe","tags":["attack.persistence","attack.privilege_escalation","attack.t1546.011"],"interval":"5m","description":"Detects installation of a new shim using sdbinst.exe. A shim can be used to load malicious DLLs into applications.","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.executable:/.*\\\\[Ss][Dd][Bb][Ii][Nn][Ss][Tt]\\.[Ee][Xx][Ee]/ AND process.command_line:/.*\\.[Ss][Dd][Bb].*/) AND (NOT (process.command_line:/.*[Ii][Ii][Ss][Ee][Xx][Pp][Rr][Ee][Ss][Ss][Ss][Hh][Ii][Mm]\\.[Ss][Dd][Bb].*/)))","rule_id":"517490a7-115a-48c6-8862-1a481504d5a8","timestamp_override":"event.ingested","references":["https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.executable:*\\\\sdbinst.exe AND process.command_line:*.sdb*) AND (NOT (process.command_line:*iisexpressshim.sdb*)))`"}

{"id":"1c12727d-02bf-45ff-a9f3-d49806a3cf43","created_by":"Nasreddine Bencherchali","name":"Execution Of Renamed Plink Binary","tags":["attack.defense_evasion","attack.t1036"],"interval":"5m","description":"Execution of a renamed version of the Plink binary","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.pe.original_file_name:/[Pp][Ll][Ii][Nn][Kk]/ OR (process.command_line:/.*\\ \\-[Ll]\\ [Ff][Oo][Rr][Ww][Aa][Rr][Dd].*/ AND process.command_line:/.*\\ \\-[Pp]\\ .*/ AND process.command_line:/.*\\ \\-[Rr]\\ .*/)) AND (NOT (process.executable:/.*\\\\[Pp][Ll][Ii][Nn][Kk]\\.[Ee][Xx][Ee]/)))","rule_id":"1c12727d-02bf-45ff-a9f3-d49806a3cf43","timestamp_override":"event.ingested","references":["https://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/","https://the.earth.li/~sgtatham/putty/0.58/htmldoc/Chapter7.html"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.pe.original_file_name:Plink OR (process.command_line:*\\ \\-l\\ forward* AND process.command_line:*\\ \\-P\\ * AND process.command_line:*\\ \\-R\\ *)) AND (NOT (process.executable:*\\\\plink.exe)))`"}

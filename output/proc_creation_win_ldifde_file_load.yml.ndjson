{"id":"6f535e01-ca1f-40be-ab8d-45b19c0c8b7f","created_by":"@gott_cyber","name":"Suspicious Ldifde Command Usage","tags":["attack.command_and_control","attack.t1105","attack.defense_evasion","attack.t1218"],"interval":"5m","description":"Detects the use of Ldifde.exe with specific command line arguments to potentially load an LDIF file containing HTTP-based arguments.\nLdifde.exe is present, by default, on domain controllers and only requires user-level authentication to execute.\n","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.executable:/.*\\\\[Ll][Dd][Ii][Ff][Dd][Ee]\\.[Ee][Xx][Ee]/ OR process.pe.original_file_name:/[Ll][Dd][Ii][Ff][Dd][Ee]\\.[Ee][Xx][Ee]\\.[Mm][Uu][Ii]/) AND (process.command_line:/.*\\-[Ii].*/ AND process.command_line:/.*\\-[Ff].*/))","rule_id":"6f535e01-ca1f-40be-ab8d-45b19c0c8b7f","timestamp_override":"event.ingested","references":["https://twitter.com/0gtweet/status/1564968845726580736","https://strontic.github.io/xcyclopedia/library/ldifde.exe-979DE101F5059CEC1D2C56967CA2BAC0.html","https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.executable:*\\\\ldifde.exe OR process.pe.original_file_name:ldifde.exe.mui) AND (process.command_line:*\\-i* AND process.command_line:*\\-f*))`"}

{"id":"e79a9e79-eb72-4e78-a628-0e7e8f59e89c","created_by":"Florian Roth","name":"Suspicious Call by Ordinal","tags":["attack.defense_evasion","attack.t1218.011"],"interval":"5m","description":"Detects suspicious calls of DLLs in rundll32.dll exports by ordinal","risk_score":73,"enabled":true,"severity":"high","false_positives":["False positives depend on scripts and administrative tools used in the monitored environment","Windows control panel elements have been identified as source (mmc)"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.executable:/.*\\\\[Rr][Uu][Nn][Dd][Ll][Ll]32\\.[Ee][Xx][Ee]/ AND process.command_line:(/.*,#.*/ OR /.*,\\ #.*/ OR /.*\\.[Dd][Ll][Ll]\\ #.*/ OR /.*\\.[Oo][Cc][Xx]\\ #.*/)) AND (NOT (process.command_line:/.*[Ee][Dd][Gg][Ee][Hh][Tt][Mm][Ll]\\.[Dd][Ll][Ll].*/ AND process.command_line:/.*#141.*/)))","rule_id":"e79a9e79-eb72-4e78-a628-0e7e8f59e89c","timestamp_override":"event.ingested","references":["https://techtalk.pcmatic.com/2017/11/30/running-dll-files-malware-analysis/","https://github.com/Neo23x0/DLLRunner","https://twitter.com/cyb3rops/status/1186631731543236608","https://www.welivesecurity.com/2022/03/01/isaacwiper-hermeticwizard-wiper-worm-targeting-ukraine/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.executable:*\\\\rundll32.exe AND process.command_line:(*,#* OR *,\\ #* OR *.dll\\ #* OR *.ocx\\ #*)) AND (NOT (process.command_line:*EDGEHTML.dll* AND process.command_line:*#141*)))`"}

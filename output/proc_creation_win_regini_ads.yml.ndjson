{"id":"77946e79-97f1-45a2-84b4-f37b5c0d8682","created_by":"Eli Salem, Sander Wiebing, oscd.community","name":"Modifies the Registry From a ADS","tags":["attack.t1112","attack.defense_evasion"],"interval":"5m","description":"Detects the import of an alternate data stream with regini.exe, regini.exe can be used to modify registry keys.","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.executable:/.*\\\\[Rr][Ee][Gg][Ii][Nn][Ii]\\.[Ee][Xx][Ee]/ OR process.pe.original_file_name:/[Rr][Ee][Gg][Ii][Nn][Ii]\\.[Ee][Xx][Ee]/) AND process.command_line:/:[^ \\\\\\\\]/)","rule_id":"77946e79-97f1-45a2-84b4-f37b5c0d8682","timestamp_override":"event.ingested","references":["https://lolbas-project.github.io/lolbas/Binaries/Regini/","https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f","https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regini"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.executable:*\\\\regini.exe OR process.pe.original_file_name:REGINI.EXE) AND process.command_line:/:[^ \\\\\\\\]/)`"}

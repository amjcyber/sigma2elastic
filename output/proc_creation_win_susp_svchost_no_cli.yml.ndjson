{"id":"16c37b52-b141-42a5-a3ea-bbe098444397","created_by":"David Burkett","name":"Suspect Svchost Activity","tags":["attack.defense_evasion","attack.privilege_escalation","attack.t1055"],"interval":"5m","description":"It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.","risk_score":73,"enabled":true,"severity":"high","false_positives":["Rpcnet.exe / rpcnetp.exe which is a lojack style software. https://www.blackhat.com/docs/us-14/materials/us-14-Kamlyuk-Kamluk-Computrace-Backdoor-Revisited.pdf"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.command_line:/.*[Ss][Vv][Cc][Hh][Oo][Ss][Tt]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Ss][Vv][Cc][Hh][Oo][Ss][Tt]\\.[Ee][Xx][Ee]/) AND (NOT (process.parent.executable:(/.*\\\\[Rr][Pp][Cc][Nn][Ee][Tt]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Rr][Pp][Cc][Nn][Ee][Tt][Pp]\\.[Ee][Xx][Ee]/) OR NOT _exists_:process.command_line)))","rule_id":"16c37b52-b141-42a5-a3ea-bbe098444397","timestamp_override":"event.ingested","references":["https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.command_line:*svchost.exe AND process.executable:*\\\\svchost.exe) AND (NOT (process.parent.executable:(*\\\\rpcnet.exe OR *\\\\rpcnetp.exe) OR NOT _exists_:process.command_line)))`"}

{"id":"295a59c1-7b79-4b47-a930-df12c15fc9c2","created_by":"Antonlovesdnb","name":"Windows Registry Trust Record Modification","tags":["attack.initial_access","attack.t1566.001"],"interval":"5m","description":"Alerts on trust record modification within the registry, indicating usage of macros","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Alerts on legitimate macro usage as well, will need to filter as appropriate"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"registry.path:/.*[Tt][Rr][Uu][Ss][Tt][Rr][Ee][Cc][Oo][Rr][Dd][Ss].*/","rule_id":"295a59c1-7b79-4b47-a930-df12c15fc9c2","timestamp_override":"event.ingested","references":["https://outflank.nl/blog/2018/01/16/hunting-for-evil-detect-macros-being-executed/","http://az4n6.blogspot.com/2016/02/more-on-trust-records-macros-and.html"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`registry.path:*TrustRecords*`"}

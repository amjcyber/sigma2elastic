{"id":"174afcfa-6e40-4ae9-af64-496546389294","created_by":"Florent Labouyrie","name":"SVCHOST Credential Dump","tags":["attack.t1548"],"interval":"5m","description":"Detects when a process, such as mimikatz, accesses the memory of svchost to dump credentials","risk_score":73,"enabled":true,"severity":"high","false_positives":["Non identified legit exectubale"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((winlog.event_data.TargetImage:/.*\\\\[Ss][Vv][Cc][Hh][Oo][Ss][Tt]\\.[Ee][Xx][Ee]/ AND winlog.event_data.GrantedAccess:/0[Xx]143[Aa]/) AND (NOT (process.executable:(/.*\\\\[Ss][Ee][Rr][Vv][Ii][Cc][Ee][Ss]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Mm][Ss][Ii][Ee][Xx][Ee][Cc]\\.[Ee][Xx][Ee]/))))","rule_id":"174afcfa-6e40-4ae9-af64-496546389294","timestamp_override":"event.ingested","references":null,"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((winlog.event_data.TargetImage:*\\\\svchost.exe AND winlog.event_data.GrantedAccess:0x143a) AND (NOT (process.executable:(*\\\\services.exe OR *\\\\msiexec.exe))))`"}

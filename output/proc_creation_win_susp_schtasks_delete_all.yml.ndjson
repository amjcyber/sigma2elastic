{"id":"220457c1-1c9f-4c2e-afe6-9598926222c1","created_by":"Nasreddine Bencherchali","name":"Delete All Scheduled Tasks","tags":["attack.impact","attack.t1489"],"interval":"5m","description":"Detects the usage of schtasks with the delete flag and the asterisk symbole to delete all tasks from the schedule of the local computer, including tasks scheduled by other users.","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unlikely"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Ss][Cc][Hh][Tt][Aa][Ss][Kk][Ss]\\.[Ee][Xx][Ee]/ AND process.command_line:/.*\\ \\/[Dd][Ee][Ll][Ee][Tt][Ee]\\ .*/ AND process.command_line:/.*\\/[Tt][Nn]\\ \\\\.*/ AND process.command_line:/.*\\ \\/[Ff].*/)","rule_id":"220457c1-1c9f-4c2e-afe6-9598926222c1","timestamp_override":"event.ingested","references":["https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-delete"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\schtasks.exe AND process.command_line:*\\ \\/delete\\ * AND process.command_line:*\\/tn\\ \\* AND process.command_line:*\\ \\/f*)`"}

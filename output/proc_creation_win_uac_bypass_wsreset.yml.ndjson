{"id":"d797268e-28a9-49a7-b9a8-2f5039011c5c","created_by":"E.M. Anhaus (originally from Atomic Blue Detections, Tony Lambert), oscd.community, Florian Roth","name":"Bypass UAC via WSReset.exe","tags":["attack.privilege_escalation","attack.defense_evasion","attack.t1548.002"],"interval":"5m","description":"Detects use of WSReset.exe to bypass User Account Control (UAC). Adversaries use this technique to execute privileged processes.","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown sub processes of Wsreset.exe"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.parent.executable:/.*\\\\[Ww][Ss][Rr][Ee][Ss][Ee][Tt]\\.[Ee][Xx][Ee]/ AND (NOT (process.executable:/.*\\\\[Cc][Oo][Nn][Hh][Oo][Ss][Tt]\\.[Ee][Xx][Ee]/ OR process.pe.original_file_name:/[Cc][Oo][Nn][Hh][Oo][Ss][Tt]\\.[Ee][Xx][Ee]/)))","rule_id":"d797268e-28a9-49a7-b9a8-2f5039011c5c","timestamp_override":"event.ingested","references":["https://eqllib.readthedocs.io/en/latest/analytics/532b5ed4-7930-11e9-8f5c-d46d6d62a49e.html","https://lolbas-project.github.io/lolbas/Binaries/Wsreset/","https://www.activecyber.us/activelabs/windows-uac-bypass","https://twitter.com/ReaQta/status/1222548288731217921"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.parent.executable:*\\\\wsreset.exe AND (NOT (process.executable:*\\\\conhost.exe OR process.pe.original_file_name:CONHOST.EXE)))`"}

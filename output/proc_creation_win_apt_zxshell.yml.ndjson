{"id":"f0b70adb-0075-43b0-9745-e82a1c608fcc","created_by":"Florian Roth, oscd.community, Jonhnathan Ribeiro","name":"ZxShell Malware","tags":["attack.execution","attack.t1059.003","attack.defense_evasion","attack.t1218.011","attack.s0412","attack.g0001"],"interval":"5m","description":"Detects a ZxShell start by the called and well-known function name","risk_score":99,"enabled":true,"severity":"critical","false_positives":["Unlikely"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Rr][Uu][Nn][Dd][Ll][Ll]32\\.[Ee][Xx][Ee]/ AND process.command_line:(/.*[Zz][Xx][Ff][Uu][Nn][Cc][Tt][Ii][Oo][Nn].*/ OR /.*[Rr][Ee][Mm][Oo][Tt][Ee][Dd][Ii][Ss][Kk][Xx][Xx][Xx][Xx][Xx].*/))","rule_id":"f0b70adb-0075-43b0-9745-e82a1c608fcc","timestamp_override":"event.ingested","references":["https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\rundll32.exe AND process.command_line:(*zxFunction* OR *RemoteDiskXXXXX*))`"}

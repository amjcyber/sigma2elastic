{"id":"f63b56ee-3f79-4b8a-97fb-5c48007e8573","created_by":"Florian Roth","name":"DNS ServerLevelPluginDll Install","tags":["attack.defense_evasion","attack.t1574.002","attack.t1112"],"interval":"5m","description":"Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required)","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Dd][Nn][Ss][Cc][Mm][Dd]\\.[Ee][Xx][Ee]/ AND process.command_line:/.*\\/[Cc][Oo][Nn][Ff][Ii][Gg].*/ AND process.command_line:/.*\\/[Ss][Ee][Rr][Vv][Ee][Rr][Ll][Ee][Vv][Ee][Ll][Pp][Ll][Uu][Gg][Ii][Nn][Dd][Ll][Ll].*/)","rule_id":"f63b56ee-3f79-4b8a-97fb-5c48007e8573","timestamp_override":"event.ingested","references":["https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\dnscmd.exe AND process.command_line:*\\/config* AND process.command_line:*\\/serverlevelplugindll*)`"}

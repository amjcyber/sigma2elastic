{"id":"8f88e3f6-2a49-48f5-a5c4-2f7eedf78710","created_by":"Florian Roth","name":"Java Running with Remote Debugging","tags":["attack.t1203","attack.execution"],"interval":"5m","description":"Detects a JAVA process running with remote debugging allowing more than just localhost to connect","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.command_line:/.*[Tt][Rr][Aa][Nn][Ss][Pp][Oo][Rr][Tt]\\=[Dd][Tt]_[Ss][Oo][Cc][Kk][Ee][Tt],[Aa][Dd][Dd][Rr][Ee][Ss][Ss]\\=.*/ AND process.command_line:(/.*[Jj][Rr][Ee]1\\..*/ OR /.*[Jj][Dd][Kk]1\\..*/)) AND (NOT (process.command_line:/.*[Aa][Dd][Dd][Rr][Ee][Ss][Ss]\\=127\\.0\\.0\\.1.*/ OR process.command_line:/.*[Aa][Dd][Dd][Rr][Ee][Ss][Ss]\\=[Ll][Oo][Cc][Aa][Ll][Hh][Oo][Ss][Tt].*/)))","rule_id":"8f88e3f6-2a49-48f5-a5c4-2f7eedf78710","timestamp_override":"event.ingested","references":["https://dzone.com/articles/remote-debugging-java-applications-with-jdwp"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.command_line:*transport\\=dt_socket,address\\=* AND process.command_line:(*jre1.* OR *jdk1.*)) AND (NOT (process.command_line:*address\\=127.0.0.1* OR process.command_line:*address\\=localhost*)))`"}

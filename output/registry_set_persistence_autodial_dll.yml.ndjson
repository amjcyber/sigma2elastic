{"id":"e6fe26ee-d063-4f5b-b007-39e90aaf50e3","created_by":"Nasreddine Bencherchali","name":"Persistence Via AutodialDLL","tags":["attack.persistence"],"interval":"5m","description":"Detects change the the \"AutodialDLL\" key which could be used as a persistence method to load custom DLL via the \"ws2_32\" library","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unlikely"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(winlog.event_data.EventType:/[Ss][Ee][Tt][Vv][Aa][Ll][Uu][Ee]/ AND registry.path:/.*\\\\[Ss][Ee][Rr][Vv][Ii][Cc][Ee][Ss]\\\\[Ww][Ii][Nn][Ss][Oo][Cc][Kk]2\\\\[Pp][Aa][Rr][Aa][Mm][Ee][Tt][Ee][Rr][Ss]\\\\[Aa][Uu][Tt][Oo][Dd][Ii][Aa][Ll][Dd][Ll][Ll].*/)","rule_id":"e6fe26ee-d063-4f5b-b007-39e90aaf50e3","timestamp_override":"event.ingested","references":["https://www.hexacorn.com/blog/2015/01/13/beyond-good-ol-run-key-part-24/","https://persistence-info.github.io/Data/autodialdll.html"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(winlog.event_data.EventType:SetValue AND registry.path:*\\\\Services\\\\WinSock2\\\\Parameters\\\\AutodialDLL*)`"}

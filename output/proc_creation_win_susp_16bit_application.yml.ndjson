{"id":"16905e21-66ee-42fe-b256-1318ada2d770","created_by":"frack113","name":"Start of NT Virtual DOS Machine","tags":["attack.defense_evasion"],"interval":"5m","description":"Ntvdm.exe allows the execution of 16-bit Windows applications on 32-bit Windows operating systems, as well as the execution of both 16-bit and 32-bit DOS applications","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Legitimate use"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"process.executable:(/.*\\\\[Nn][Tt][Vv][Dd][Mm]\\.[Ee][Xx][Ee]/ OR /.*\\\\[Cc][Ss][Rr][Ss][Tt][Uu][Bb]\\.[Ee][Xx][Ee]/)","rule_id":"16905e21-66ee-42fe-b256-1318ada2d770","timestamp_override":"event.ingested","references":["https://docs.microsoft.com/en-us/windows/compatibility/ntvdm-and-16-bit-app-support","https://support.microsoft.com/fr-fr/topic/an-ms-dos-based-program-that-uses-the-ms-dos-protected-mode-interface-crashes-on-a-computer-that-is-running-windows-7-5dc739ea-987b-b458-15e4-d28d5cca63c7","https://app.any.run/tasks/93fe92fa-8b2b-4d92-8c09-a841aed2e793/","https://app.any.run/tasks/214094a7-0abc-4a7b-a564-1b757faed79d/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`process.executable:(*\\\\ntvdm.exe OR *\\\\csrstub.exe)`"}

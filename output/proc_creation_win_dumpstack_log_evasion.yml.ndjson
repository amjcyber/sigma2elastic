{"id":"4f647cfa-b598-4e12-ad69-c68dd16caef8","created_by":"Florian Roth","name":"DumpStack.log Defender Evasion","tags":["attack.defense_evasion"],"interval":"5m","description":"Detects the use of the filename DumpStack.log to evade Microsoft Defender","risk_score":99,"enabled":true,"severity":"critical","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Dd][Uu][Mm][Pp][Ss][Tt][Aa][Cc][Kk]\\.[Ll][Oo][Gg]/ OR process.command_line:/.*\\ \\-[Oo]\\ [Dd][Uu][Mm][Pp][Ss][Tt][Aa][Cc][Kk]\\.[Ll][Oo][Gg].*/)","rule_id":"4f647cfa-b598-4e12-ad69-c68dd16caef8","timestamp_override":"event.ingested","references":["https://twitter.com/mrd0x/status/1479094189048713219"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\DumpStack.log OR process.command_line:*\\ \\-o\\ DumpStack.log*)`"}

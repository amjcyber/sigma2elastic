{"id":"58bf96d9-ff5f-44bd-8dcc-1c4f79bf3a27","created_by":"Florian Roth","name":"Trickbot Malware Activity","tags":["attack.execution","attack.t1559"],"interval":"5m","description":"Detects Trickbot malware process tree pattern in which rundll32.exe is parent of wermgr.exe","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Ww][Ee][Rr][Mm][Gg][Rr]\\.[Ee][Xx][Ee]/ AND process.parent.executable:/.*\\\\[Rr][Uu][Nn][Dd][Ll][Ll]32\\.[Ee][Xx][Ee]/ AND process.parent.command_line:/.*[Dd][Ll][Ll][Rr][Ee][Gg][Ii][Ss][Tt][Ee][Rr][Ss][Ee][Rr][Vv][Ee][Rr].*/)","rule_id":"58bf96d9-ff5f-44bd-8dcc-1c4f79bf3a27","timestamp_override":"event.ingested","references":["https://twitter.com/swisscom_csirt/status/1331634525722521602?s=20","https://app.any.run/tasks/f74c5157-8508-4ac6-9805-d63fe7b0d399/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\wermgr.exe AND process.parent.executable:*\\\\rundll32.exe AND process.parent.command_line:*DllRegisterServer*)`"}

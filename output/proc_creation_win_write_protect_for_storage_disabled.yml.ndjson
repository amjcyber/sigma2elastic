{"id":"75f7a0e2-7154-4c4d-9eae-5cdb4e0a5c13","created_by":"Sreeman","name":"Write Protect For Storage Disabled","tags":["attack.defense_evasion","attack.t1562"],"interval":"5m","description":"Looks for changes to registry to disable any write-protect property for storage devices. This could be a precursor to a ransomware attack and has been an observed technique used by cypherpunk group.","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.command_line:/.*[Rr][Ee][Gg]\\ [Aa][Dd][Dd].*/ AND process.command_line:/.*\\\\[Ss][Yy][Ss][Tt][Ee][Mm]\\\\[Cc][Uu][Rr][Rr][Ee][Nn][Tt][Cc][Oo][Nn][Tt][Rr][Oo][Ll][Ss][Ee][Tt]\\\\[Cc][Oo][Nn][Tt][Rr][Oo][Ll].*/ AND process.command_line:/.*[Ww][Rr][Ii][Tt][Ee]\\ [Pp][Rr][Oo][Tt][Ee][Cc][Tt][Ii][Oo][Nn].*/ AND process.command_line:/.*0.*/ AND process.command_line:(/.*[Ss][Tt][Oo][Rr][Aa][Gg][Ee].*/ OR /.*[Ss][Tt][Oo][Rr][Aa][Gg][Ee][Dd][Ee][Vv][Ii][Cc][Ee][Pp][Oo][Ll][Ii][Cc][Ii][Ee][Ss].*/))","rule_id":"75f7a0e2-7154-4c4d-9eae-5cdb4e0a5c13","timestamp_override":"event.ingested","references":null,"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.command_line:*reg\\ add* AND process.command_line:*\\\\system\\\\currentcontrolset\\\\control* AND process.command_line:*write\\ protection* AND process.command_line:*0* AND process.command_line:(*storage* OR *storagedevicepolicies*))`"}

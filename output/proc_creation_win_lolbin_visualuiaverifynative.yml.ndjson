{"id":"b30a8bc5-e21b-4ca2-9420-0a94019ac56a","created_by":"Christopher Peacock @SecurePeacock, SCYTHE @scythe_io","name":"Use of VisualUiaVerifyNative.exe","tags":["attack.defense_evasion","attack.t1218"],"interval":"5m","description":"VisualUiaVerifyNative.exe is a Windows SDK that can be used for AWL bypass and is listed in Microsoft's recommended block rules.","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Legitimate testing of Microsoft UI parts."],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:/.*\\\\[Vv][Ii][Ss][Uu][Aa][Ll][Uu][Ii][Aa][Vv][Ee][Rr][Ii][Ff][Yy][Nn][Aa][Tt][Ii][Vv][Ee]\\.[Ee][Xx][Ee]/ OR process.pe.original_file_name:/[Vv][Ii][Ss][Uu][Aa][Ll][Uu][Ii][Aa][Vv][Ee][Rr][Ii][Ff][Yy][Nn][Aa][Tt][Ii][Vv][Ee]\\.[Ee][Xx][Ee]/)","rule_id":"b30a8bc5-e21b-4ca2-9420-0a94019ac56a","timestamp_override":"event.ingested","references":["https://lolbas-project.github.io/lolbas/OtherMSBinaries/VisualUiaVerifyNative/","https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules","https://bohops.com/2020/10/15/exploring-the-wdac-microsoft-recommended-block-rules-visualuiaverifynative/","https://github.com/MicrosoftDocs/windows-itpro-docs/commit/937db704b9148e9cee7c7010cad4d00ce9c4fdad"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:*\\\\VisualUiaVerifyNative.exe OR process.pe.original_file_name:VisualUiaVerifyNative.exe)`"}

{"id":"e76c8240-d68f-4773-8880-5c6f63595aaf","created_by":"Ensar Åžamil, @sblmsrsn, @oscd_initiative","name":"Time Travel Debugging Utility Usage","tags":["attack.defense_evasion","attack.credential_access","attack.t1218","attack.t1003.001"],"interval":"5m","description":"Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.","risk_score":73,"enabled":true,"severity":"high","false_positives":["Legitimate usage by software developers/testers"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"file.path:(/.*\\\\[Tt][Tt][Dd][Rr][Ee][Cc][Oo][Rr][Dd]\\.[Dd][Ll][Ll]/ OR /.*\\\\[Tt][Tt][Dd][Ww][Rr][Ii][Tt][Ee][Rr]\\.[Dd][Ll][Ll]/ OR /.*\\\\[Tt][Tt][Dd][Ll][Oo][Aa][Dd][Ee][Rr]\\.[Dd][Ll][Ll]/)","rule_id":"e76c8240-d68f-4773-8880-5c6f63595aaf","timestamp_override":"event.ingested","references":["https://lolbas-project.github.io/lolbas/Binaries/Tttracer/","https://twitter.com/mattifestation/status/1196390321783025666","https://twitter.com/oulusoyum/status/1191329746069655553"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`file.path:(*\\\\ttdrecord.dll OR *\\\\ttdwriter.dll OR *\\\\ttdloader.dll)`"}

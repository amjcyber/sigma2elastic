{"id":"35efb964-e6a5-47ad-bbcd-19661854018d","created_by":"Florian Roth","name":"Execution in Webserver Root Folder","tags":["attack.persistence","attack.t1505.003"],"interval":"5m","description":"Detects a suspicious program execution in a web service root folder (filter out false positives)","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Various applications","Tools that include ping or nslookup command invocations"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.executable:(/.*\\\\[Ww][Ww][Ww][Rr][Oo][Oo][Tt]\\\\.*/ OR /.*\\\\[Ww][Mm][Pp][Uu][Bb]\\\\.*/ OR /.*\\\\[Hh][Tt][Dd][Oo][Cc][Ss]\\\\.*/) AND (NOT (process.executable:(/.*[Bb][Ii][Nn]\\\\.*/ OR /.*\\\\[Tt][Oo][Oo][Ll][Ss]\\\\.*/ OR /.*\\\\[Ss][Mm][Ss][Cc][Oo][Mm][Pp][Oo][Nn][Ee][Nn][Tt]\\\\.*/) AND process.parent.executable:/.*\\\\[Ss][Ee][Rr][Vv][Ii][Cc][Ee][Ss]\\.[Ee][Xx][Ee]/)))","rule_id":"35efb964-e6a5-47ad-bbcd-19661854018d","timestamp_override":"event.ingested","references":null,"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.executable:(*\\\\wwwroot\\\\* OR *\\\\wmpub\\\\* OR *\\\\htdocs\\\\*) AND (NOT (process.executable:(*bin\\\\* OR *\\\\Tools\\\\* OR *\\\\SMSComponent\\\\*) AND process.parent.executable:*\\\\services.exe)))`"}

{"id":"eb1c4225-1c23-4241-8dd4-051389fde4ce","created_by":"Florian Roth","name":"Suspicious DumpMinitool Usage","tags":["attack.defense_evasion","attack.t1036","attack.t1003.001"],"interval":"5m","description":"Detects suspicious ways to use of a Visual Studio bundled tool named DumpMinitool.exe","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.executable:/.*\\\\[Dd][Uu][Mm][Pp][Mm][Ii][Nn][Ii][Tt][Oo][Oo][Ll]\\.[Ee][Xx][Ee]/ OR OriginalName:/[Dd][Uu][Mm][Pp][Mm][Ii][Nn][Ii][Tt][Oo][Oo][Ll]\\.[Ee][Xx][Ee]/) AND (((NOT (process.executable:(/.*\\\\[Mm][Ii][Cc][Rr][Oo][Ss][Oo][Ff][Tt]\\ [Vv][Ii][Ss][Uu][Aa][Ll]\\ [Ss][Tt][Uu][Dd][Ii][Oo]\\\\.*/ OR /.*\\\\[Ee][Xx][Tt][Ee][Nn][Ss][Ii][Oo][Nn][Ss]\\\\.*/))) OR process.command_line:/.*\\.[Tt][Xx][Tt].*/) OR (process.command_line:/.*\\ [Ff][Uu][Ll][Ll].*/ AND (NOT (process.command_line:/.*\\-\\-[Dd][Uu][Mm][Pp][Tt][Yy][Pp][Ee].*/)))))","rule_id":"eb1c4225-1c23-4241-8dd4-051389fde4ce","timestamp_override":"event.ingested","references":["https://twitter.com/mrd0x/status/1511415432888131586","https://twitter.com/mrd0x/status/1511489821247684615"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.executable:*\\\\DumpMinitool.exe OR OriginalName:DumpMinitool.exe) AND (((NOT (process.executable:(*\\\\Microsoft\\ Visual\\ Studio\\\\* OR *\\\\Extensions\\\\*))) OR process.command_line:*.txt*) OR (process.command_line:*\\ Full* AND (NOT (process.command_line:*\\-\\-dumpType*)))))`"}

{"id":"7d4cdc5a-0076-40ca-aac8-f7e714570e47","created_by":"Nik Seetharaman","name":"CMSTP Execution Process Creation","tags":["attack.defense_evasion","attack.execution","attack.t1218.003","attack.g0069","car.2019-04-001"],"interval":"5m","description":"Detects various indicators of Microsoft Connection Manager Profile Installer execution","risk_score":73,"enabled":true,"severity":"high","false_positives":["Legitimate CMSTP use (unlikely in modern enterprise environments)"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"process.parent.executable:/.*\\\\[Cc][Mm][Ss][Tt][Pp]\\.[Ee][Xx][Ee]/","rule_id":"7d4cdc5a-0076-40ca-aac8-f7e714570e47","timestamp_override":"event.ingested","references":["https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`process.parent.executable:*\\\\cmstp.exe`"}

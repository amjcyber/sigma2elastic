{"id":"fdd84c68-a1f6-47c9-9477-920584f94905","created_by":"Florian Roth","name":"Exploit for CVE-2017-8759","tags":["attack.execution","attack.t1203","attack.t1204.002","attack.initial_access","attack.t1566.001"],"interval":"5m","description":"Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759","risk_score":99,"enabled":true,"severity":"critical","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.parent.executable:/.*\\\\[Ww][Ii][Nn][Ww][Oo][Rr][Dd]\\.[Ee][Xx][Ee]/ AND process.executable:/.*\\\\[Cc][Ss][Cc]\\.[Ee][Xx][Ee]/)","rule_id":"fdd84c68-a1f6-47c9-9477-920584f94905","timestamp_override":"event.ingested","references":["https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100","https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.parent.executable:*\\\\WINWORD.EXE AND process.executable:*\\\\csc.exe)`"}

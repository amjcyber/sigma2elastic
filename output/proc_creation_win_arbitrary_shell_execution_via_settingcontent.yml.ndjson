{"id":"24de4f3b-804c-4165-b442-5a06a2302c7e","created_by":"Sreeman","name":"Arbitrary Shell Command Execution Via Settingcontent-Ms","tags":["attack.t1204","attack.t1566.001","attack.execution","attack.initial_access"],"interval":"5m","description":"The .SettingContent-ms file type was introduced in Windows 10 and allows a user to create \"shortcuts\" to various Windows 10 setting pages. These files are simply XML and contain paths to various Windows 10 settings binaries.","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(process.command_line:/.*\\.[Ss][Ee][Tt][Tt][Ii][Nn][Gg][Cc][Oo][Nn][Tt][Ee][Nn][Tt]\\-[Mm][Ss].*/ AND (NOT (process.command_line:/.*[Ii][Mm][Mm][Ee][Rr][Ss][Ii][Vv][Ee][Cc][Oo][Nn][Tt][Rr][Oo][Ll][Pp][Aa][Nn][Ee][Ll].*/)))","rule_id":"24de4f3b-804c-4165-b442-5a06a2302c7e","timestamp_override":"event.ingested","references":["https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(process.command_line:*.SettingContent\\-ms* AND (NOT (process.command_line:*immersivecontrolpanel*)))`"}

{"id":"204b17ae-4007-471b-917b-b917b315c5db","created_by":"frack113","name":"Suspicious Del in CommandLine","tags":["attack.defense_evasion","attack.t1070.004"],"interval":"5m","description":"Detects suspicious command line to remove and 'exe' or 'dll'","risk_score":47,"enabled":true,"severity":"medium","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"((process.command_line:/.*[Dd][Ee][Ll]\\ .*/ AND process.command_line:/.*\\*\\.[Ee][Xx][Ee].*/ AND process.command_line:/.*\\/[Ff]\\ .*/ AND process.command_line:/.*\\/[Qq]\\ .*/) OR (process.command_line:/.*[Dd][Ee][Ll]\\ .*/ AND process.command_line:/.*\\*\\.[Dd][Ll][Ll].*/ AND process.command_line:/.*[Cc]\\:\\\\[Pp][Rr][Oo][Gg][Rr][Aa][Mm][Dd][Aa][Tt][Aa]\\\\.*/))","rule_id":"204b17ae-4007-471b-917b-b917b315c5db","timestamp_override":"event.ingested","references":["https://www.joesandbox.com/analysis/509330/0/html#1044F3BDBE3BB6F734E357235F4D5898582D"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`((process.command_line:*del\\ * AND process.command_line:*\\*.exe* AND process.command_line:*\\/f\\ * AND process.command_line:*\\/q\\ *) OR (process.command_line:*del\\ * AND process.command_line:*\\*.dll* AND process.command_line:*C\\:\\\\ProgramData\\\\*))`"}

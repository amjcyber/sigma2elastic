{"id":"39776c99-1c7b-4ba0-b5aa-641525eee1a4","created_by":"oscd.community, Natalia Shornikova","name":"Execution via CL_Mutexverifiers.ps1","tags":["attack.defense_evasion","attack.t1216"],"interval":"5m","description":"Detects Execution via runAfterCancelProcess in CL_Mutexverifiers.ps1 module","risk_score":73,"enabled":true,"severity":"high","false_positives":["Unknown"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"(powershell.file.script_block_text:/.*[Cc][Ll]_[Mm][Uu][Tt][Ee][Xx][Vv][Ee][Rr][Ii][Ff][Ii][Ee][Rr][Ss]\\.[Pp][Ss]1.*/ AND powershell.file.script_block_text:/.*[Rr][Uu][Nn][Aa][Ff][Tt][Ee][Rr][Cc][Aa][Nn][Cc][Ee][Ll][Pp][Rr][Oo][Cc][Ee][Ss][Ss].*/)","rule_id":"39776c99-1c7b-4ba0-b5aa-641525eee1a4","timestamp_override":"event.ingested","references":["https://lolbas-project.github.io/lolbas/Scripts/CL_mutexverifiers/","https://twitter.com/pabraeken/status/995111125447577600"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`(powershell.file.script_block_text:*CL_Mutexverifiers.ps1* AND powershell.file.script_block_text:*runAfterCancelProcess*)`"}

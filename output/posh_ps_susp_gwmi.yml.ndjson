{"id":"0332a266-b584-47b4-933d-a00b103e1b37","created_by":"frack113","name":"Suspicious Get-WmiObject","tags":["attack.persistence","attack.t1546"],"interval":"5m","description":"The infrastructure for management data and operations that enables local and remote management of Windows personal computers and servers","risk_score":21,"enabled":true,"severity":"low","false_positives":["Legitimate PowerShell scripts"],"from":"now-720s","type":"query","language":"lucene","index":["winlogbeat-*","logs-*"],"query":"powershell.file.script_block_text:(/.*[Gg][Ee][Tt]\\-[Ww][Mm][Ii][Oo][Bb][Jj][Ee][Cc][Tt].*/ OR /.*[Gg][Ww][Mm][Ii].*/)","rule_id":"0332a266-b584-47b4-933d-a00b103e1b37","timestamp_override":"event.ingested","references":["https://attack.mitre.org/datasources/DS0005/","https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1&viewFallbackFrom=powershell-7"],"note":"**Detection Rule without Regex for better understanding. Be careful, this way is case sensitive:**`powershell.file.script_block_text:(*Get\\-WmiObject* OR *gwmi*)`"}
